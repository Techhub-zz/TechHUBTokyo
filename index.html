<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Techhubtokyo : TechHUBTokyo website" />

    <link rel="stylesheet" type="text/less" media="screen" href="stylesheets/less/stylesheet.less">
	<link rel="stylesheet" type="text/css" href="stylesheets/basic.css"/>
	<link rel="stylesheet" type="text/less" href="stylesheets/less/items.less"/>
	<script type="text/javascript" src="javascripts/less-1.3.0.min.js"></script>
    <title>TechHUB Tokyo 2012</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
          <h1 id="project_title">TechHUB Tokyo 2012</h1>
          <h2 id="project_tagline">学生向け無料技術講義 開催中！</h2>

          <section id="downloads">
			<div class="icons">
				
				<a class="concept" href="html/concept.html">concept</a>
				<a class="backnumber" href="html/backnumber.html">backnumber</a>
            	<a class="tweet" href="http://twitter.com/#!/techhubjp">Twitter</a>
                <a class="message" href="mailto:techhub.tokyo@gmail.com">message</a>
				
			</div>
            </section>
        </header>
    </div>


	<script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
	
	<li class="itemList">
		<div id="item">
			<div class="subjectTitle">
				<div class="imageBox">
					
					<a id="faceLinkID0" href="">
						<img id="faceImageID0" src="" />
					</a>
					
					<a id="titleImageID0" href="">
						<img id="subjectImageID0"src="" />
						<p id="subjectTitleID0" class="titleBlock"></p>
					</a>
					
				</div>
			</div>
			
			<div class="subjectDetail">
			
				<div class="subjectPlace">
					<a id="mapLinkID0" href="">
						<img id="mapImageID0" src="" />
					</a>
				</div>
				
				<div class="subjectDescription">
					<p id="subjectDescriptionID0" class="description"></p>
				</div>
				
			</div>
			
			<div class="subjectStatus">
			
				
				<div class="subjectStatusRight">
					
					<p class="limit">定員</p>
					<p id="peopleNumID0" class="peopleNum"></p>
					<p class="num">名</p>

					<a id="contentsID0" href="">
						<img id="detailImageID0" src="" />
					</a>
				</div>
				<div id="weekID0" class="subjectStatusLeft"></div>
				
			</div>
			
		</div>
	</li>

	<div class="delim"></div>

	<li class="itemList">
		<div id="item">
			<div class="subjectTitle">
				<div class="imageBox">

					<a id="faceLinkID1" href="">
						<img id="faceImageID1" src="" />
					</a>

					<a id="titleImageID1" href="">
						<img id="subjectImageID1"src="" />
						<p id="subjectTitleID1" class="titleBlock"></p>
					</a>

				</div>
			</div>

			<div class="subjectDetail">

				<div class="subjectPlace">
					<a id="mapLinkID1" href="">
						<img id="mapImageID1" src="" />
					</a>
				</div>

				<div class="subjectDescription">
					<p id="subjectDescriptionID1" class="description"></p>
				</div>

			</div>

			<div class="subjectStatus">
				

				<div class="subjectStatusRight">

					<p class="limit">定員</p>
					<p id="peopleNumID1" class="peopleNum"></p>
					<p class="num">名</p>

					<a id="contentsID1" href="">
						<img id="detailImageID1" src="" />
					</a>
				</div>
				<div id="weekID1" class="subjectStatusLeft"></div>
			</div>

		</div>
	</li>

	<div class="delim"></div>
	
	</section>
    </div>
	
<!-- js loading -->
<script type="text/javascript">

	function addRefToID(linkID, addURL) {
		var baseTag0 = document.getElementById(linkID);
		//get current domain
		domains = location.href.split(/\/+/g);
		delete domains[domains.length - 1];
		domains = domains.join('/');
		
		baseTag0.href = domains + addURL;
	}

	function setRefToID(linkID, linkURL) {
		var baseTag1 = document.getElementById(linkID);
		baseTag1.href = linkURL;
	}
	
	function setImageToID(linkID, imageURL) {
		var baseTag2 = document.getElementById(linkID);
		baseTag2.src = imageURL;
	}
	
	function setInnerTextID(linkID, text) {
		var baseTag3 = document.getElementById(linkID);
		baseTag3.innerHTML = text;
	}

	google.load("visualization", "1", {'packages':['table']});

	init=function(){
	    var sourceSheet="https://spreadsheets.google.com/spreadsheet/pub?hl=ja&hl=ja&key=0Ah5AXQBL-Nz3dEpJcVZ2Uy1KTGpJNEFZdTZQaUxQa0E";
	    var query = new google.visualization.Query(sourceSheet);
	    query.send(handleResponse);
	}
	google.setOnLoadCallback(init);


	
	var handleResponse=function(response){
		var div=document.getElementById('res');
	  	if(response.isError()) {
	    	div.innerHTML = response.getDetailedMessage();
	    	return;
	  	}
	
	  	var data = response.getDataTable();
	
		var escapeHtml = function(text) {
			if (text == null) {
				return '';
			}
			return text.replace(/&/g, '&').
			replace(/</g, '<').
			replace(/>/g, '>').
			replace(/"/g, '"');
		}
	  	for (var row = 0; row < data.getNumberOfRows(); row++) {

			var currentIndex = escapeHtml(data.getFormattedValue(row, 13));//ID	param
			addRefToID("contentsID"+row, currentIndex);
			addRefToID("titleImageID"+row, currentIndex);
			
			for (var col = 0; col < data.getNumberOfColumns(); col++) {
				switch (col) {
					case 0://faceImageID

					setImageToID("faceImageID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					case 1://faceLinkID

					setRefToID("faceLinkID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
				
					case 2://mapImageID

					setImageToID("mapImageID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
										
					case 3://logoLinkID

					setRefToID("mapLinkID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					

					case 4://subjectImageID

					setImageToID("subjectImageID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					case 5://subjectTitleID

					setInnerTextID("subjectTitleID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					// case 6://yearID
					// 					alert("6");
					// 					setInnerTextID("yearID"+row, escapeHtml(data.getFormattedValue(row, col)));
					// 					break;
					// 					
					// 					case 7://monthAndDayID
					// 					alert("7");
					// 					setInnerTextID("monthAndDayID"+row, escapeHtml(data.getFormattedValue(row, col)));
					// 					break;
					
					case 8://Tags
					var str = escapeHtml(data.getFormattedValue(row, col));
					var array = str.split(',');
					
					for (currentData in array) {
						var dataTag = document.createElement('div');
						dataTag.className = "subjectInfo";
						
						var outsideATag;
						var element = document.createElement('p');
						
						var appnedingElement = element;
						
						var text = array[currentData];
						
						var fixedCssClassName = "mini";
						
						if (text.indexOf('^') != -1) {//drop into a-tag for "link"
							outsideATag = document.createElement('a');
 							outsideATag.appendChild(element);
							outsideATag.id = "subjectTagLink"+row;
							
							fixedCssClassName = fixedCssClassName + "WithALink";
							
							//set link
							outsideATag.href = text.slice(text.indexOf('^')+1, text.length);
							text = text.slice(0,text.indexOf('^'));
							
							appnedingElement = outsideATag;
						}
						
						element.className = fixedCssClassName;
						
						element.innerHTML = text;
						var id = "weekID" + row;
						var objBody = document.getElementById(id);
						
						dataTag.appendChild(appnedingElement);
						objBody.appendChild(dataTag);
					}
					break;
					
					// case 9://subscriptionID
					// 					alert("9");
					// 					setInnerTextID("subscriptionID"+row, escapeHtml(data.getFormattedValue(row, col)));
					// 					break;
					
					case 10://subjectDescriptionID
					// alert("10");
					setInnerTextID("subjectDescriptionID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					case 11://peopleNumID
					// alert("11");
					setInnerTextID("peopleNumID"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					
					case 12://detailImageID
					// alert("12");
					var num = escapeHtml(data.getFormattedValue(row, col));
					switch (num) {
						case "0":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail0.png");
						break;
						
						case "1":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail1.png");
						break;
						
						case "2":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail2.png");
						break;
						
						case "3":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail3.png");
						break;
						
						case "4":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail4.png");
						break;
						
						case "5":
						setImageToID("detailImageID"+row, "http://www.techhubjp.org/wp-content/themes/constellation/image/inDetailButtons/inDetail5.png");
						break;
						}
					break;
					
					case 13://subjectID
					//setRefToID("subjectLinkID"+row, escapeHtml(data.getFormattedValue(row, col)));
					//setRefToID("subjectLinkIDSub"+row, escapeHtml(data.getFormattedValue(row, col)));
					break;
					
					
					
					default:
					break;
				}
			}
	  	}
	}
</script>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Techhubtokyo maintained by <a href="https://github.com/Techhub">Techhub</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
